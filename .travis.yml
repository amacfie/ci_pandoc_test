sudo: required
dist: trusty

language: node_js
node_js:
  - "6"
before_install:
# install good version of ghc
  - sudo add-apt-repository ppa:hvr/ghc -y
  - sudo apt-get update -q
  - sudo apt-get install -y ghc-8.0.2
  - PATH=${PATH}:/opt/ghc/8.0.2/bin
# install good version of cabal
  - sudo apt-get install -y cabal-install-1.24
  - PATH=${PATH}:/opt/cabal/1.24/bin
  - cabal update
# install pandoc and pandoc-citeproc filter
  - wget "https://github.com/jgm/pandoc/releases/download/1.19.2.1/pandoc-1.19.2.1-1-amd64.deb"
  - sudo dpkg -i pandoc-1.19.2.1-1-amd64.deb
# install pandoc-crossref filter
# https://github.com/lierdakil/pandoc-crossref#installation
  - mkdir pandoc-build ; cd pandoc-build
  - cabal sandbox init
  - cabal install pandoc-crossref
  - PATH=${PATH}:`pwd`/.cabal-sandbox/bin
  - cd ../
# install pandoc-numbering filter
  - sudo apt-get install -y python-pip
  - sudo pip install pandoc-numbering
before_script:
  - npm install shelljs
  - npm install yargs
  - npm install node-sass
  - PATH=${PATH}:`pwd`/node_modules/node-sass/bin
script: node ./build.js -g
branches:
  only:
  - master
# GitHub token must be re-encrypted for each new repo
env:
  global:
    secure: oDfqyuXQWVwqGHmZxp8kkViEkAa1lh4jH3TzuE9iLKrGk8YgGq0gq+519n+/WXFY9Iv+yHVfJFFV/wRyrE+NKMRuVguVeU+gyqrTTYbIxOGaJon3WkjyBaRMUjdqzQ70sKik+0XO/eKvXwJm800+ubvIk8b2liQRT7ZZ4fx8SH35XpQg4ILREJIJlK/AM3pv5FE8pGGs77YIn/TlpSLLesQLIFZey3jnhgRjVFLxXTQ9i++IycrzXEeB+utPpyWXG8JoHHIf3TUKM3n2ajeAwVzlyEnEUROw2dPeVP45a5kfpP9NcaM797wXNe7R8SkJCIqu3OCA8p/NwamuVTRlrqUjRLmWkgdUak5AIzdDjmKXCr3Vm+4+90/XT9vkb39sZupjpqyVkB7V7C5IyfTKWsF5F8TUcadj18yqCX/Bm3Cxw058oQwn5Rx+f6zvh7ZJ3IZEpBeBjSqKI82/UrOoaoCWnfop1x+MrmB0Ktqe5WP9QWUJxjaFzBhw7GiUgecOnfP/oCcBH2sUVh0f6p8Mjdjga5wkgFHRu3290v0DUEjcbywtCOFD0PNezI/8KMIadzrLPm4lDjfOBYa2Er/PMCe6S7UBE39GGU8iaUs0pucCkNF7PgxC8Izi7HvTr6hsSeBHE2+Jtm8uOay7WxbInP0ijH2SdLIgUMn90HTKbEY=

